
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>gvar.dataset - Random Data Sets &#8212; gvar 12.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/pyramid.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Numerical Analysis Modules in gvar" href="gvar_other.html" />
    <link rel="prev" title="gvar - Gaussian Random Variables" href="gvar.html" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head><body>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="gvar_other.html" title="Numerical Analysis Modules in gvar"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="gvar.html" title="gvar - Gaussian Random Variables"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">gvar 12.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><code class="xref py py-mod docutils literal notranslate"><span class="pre">gvar.dataset</span></code> - Random Data Sets</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="gvar-dataset-random-data-sets">
<h1><a class="reference internal" href="#module-gvar.dataset" title="gvar.dataset: Tools for analyzing collections of random samples."><code class="xref py py-mod docutils literal notranslate"><span class="pre">gvar.dataset</span></code></a> - Random Data Sets<a class="headerlink" href="#gvar-dataset-random-data-sets" title="Permalink to this heading">¶</a></h1>
<span class="target" id="module-gvar.dataset"></span><section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">¶</a></h2>
<p><a class="reference internal" href="#module-gvar.dataset" title="gvar.dataset: Tools for analyzing collections of random samples."><code class="xref py py-mod docutils literal notranslate"><span class="pre">gvar.dataset</span></code></a> contains a several tools for collecting and analyzing
random samples from arbitrary distributions. The random samples are
represented by lists of numbers or arrays, where each number/array is a new
sample from the underlying distribution. For example, six samples from a
one-dimensional gaussian distribution, 1±1, might look like</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">random_numbers</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.739</span><span class="p">,</span> <span class="mf">2.682</span><span class="p">,</span> <span class="mf">2.493</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.460</span><span class="p">,</span> <span class="mf">0.603</span><span class="p">,</span> <span class="mf">0.800</span><span class="p">]</span>
</pre></div>
</div>
<p>while six samples from a two-dimensional distribution, [1±1, 2±1],
might be</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">random_arrays</span> <span class="o">=</span> <span class="p">[[</span> <span class="mf">0.494</span><span class="p">,</span> <span class="mf">2.734</span><span class="p">],</span> <span class="p">[</span> <span class="mf">0.172</span><span class="p">,</span> <span class="mf">1.400</span><span class="p">],</span> <span class="p">[</span> <span class="mf">1.571</span><span class="p">,</span> <span class="mf">1.304</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span> <span class="mf">1.532</span><span class="p">,</span> <span class="mf">1.510</span><span class="p">],</span> <span class="p">[</span> <span class="mf">0.669</span><span class="p">,</span> <span class="mf">0.873</span><span class="p">],</span> <span class="p">[</span> <span class="mf">1.242</span><span class="p">,</span> <span class="mf">2.188</span><span class="p">]]</span>
</pre></div>
</div>
<p>Samples from more complicated multidimensional distributions are represented
by dictionaries whose values are lists of numbers or arrays: for example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">random_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">random_numbers</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">random_arrays</span><span class="p">)</span>
</pre></div>
</div>
<p>where list elements <code class="docutils literal notranslate"><span class="pre">random_dict['n'][i]</span></code> and <code class="docutils literal notranslate"><span class="pre">random_dict['a'][i]</span></code> are
part of the same multidimensional sample for every <code class="docutils literal notranslate"><span class="pre">i</span></code> — that is, the
lists for different keys in the dictionary are synchronized one with the
other.</p>
<p>With large samples, we typically want to estimate the mean value of the
underlying distribution. This is done using <a class="reference internal" href="#gvar.dataset.avg_data" title="gvar.dataset.avg_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">gvar.dataset.avg_data()</span></code></a>:
for example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">avg_data</span><span class="p">(</span><span class="n">random_numbers</span><span class="p">))</span>
<span class="go">1.31(45)</span>
</pre></div>
</div>
<p>indicates that <code class="docutils literal notranslate"><span class="pre">1.31(45)</span></code> is our best guess, based only upon the samples in
<code class="docutils literal notranslate"><span class="pre">random_numbers</span></code>, for the mean of the distribution from which those samples
were drawn. Similarly</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">avg_data</span><span class="p">(</span><span class="n">random_arrays</span><span class="p">))</span>
<span class="go">[0.95(22) 1.67(25)]</span>
</pre></div>
</div>
<p>indicates that the means for the two-dimensional distribution behind
<code class="docutils literal notranslate"><span class="pre">random_arrays</span></code> are <code class="docutils literal notranslate"><span class="pre">[0.95(22),</span> <span class="pre">1.67(25)]</span></code>. <a class="reference internal" href="#gvar.dataset.avg_data" title="gvar.dataset.avg_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">avg_data()</span></code></a> can also
be applied to a dictionary whose values are lists of numbers/arrays: for
example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">avg_data</span><span class="p">(</span><span class="n">random_dict</span><span class="p">))</span>
<span class="go">{&#39;a&#39;: array([0.95(22), 1.67(25)], dtype=object),&#39;n&#39;: 1.31(45)}</span>
</pre></div>
</div>
<p>Class <a class="reference internal" href="#gvar.dataset.Dataset" title="gvar.dataset.Dataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">gvar.dataset.Dataset</span></code></a> can be used to assemble dictionaries containing
random samples. For example, imagine that the random samples above were
originally written into a file, as they were generated:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># file: datafile</span>
<span class="n">n</span> <span class="mf">1.739</span>
<span class="n">a</span> <span class="p">[</span> <span class="mf">0.494</span><span class="p">,</span> <span class="mf">2.734</span><span class="p">]</span>
<span class="n">n</span> <span class="mf">2.682</span>
<span class="n">a</span> <span class="p">[</span> <span class="mf">0.172</span><span class="p">,</span> <span class="mf">1.400</span><span class="p">]</span>
<span class="n">n</span> <span class="mf">2.493</span>
<span class="n">a</span> <span class="p">[</span> <span class="mf">1.571</span><span class="p">,</span> <span class="mf">1.304</span><span class="p">]</span>
<span class="n">n</span> <span class="o">-</span><span class="mf">0.460</span>
<span class="n">a</span> <span class="p">[</span> <span class="mf">1.532</span><span class="p">,</span> <span class="mf">1.510</span><span class="p">]</span>
<span class="n">n</span> <span class="mf">0.603</span>
<span class="n">a</span> <span class="p">[</span> <span class="mf">0.669</span><span class="p">,</span> <span class="mf">0.873</span><span class="p">]</span>
<span class="n">n</span> <span class="mf">0.800</span>
<span class="n">a</span> <span class="p">[</span> <span class="mf">1.242</span><span class="p">,</span> <span class="mf">2.188</span><span class="p">]</span>
</pre></div>
</div>
<p>Here each line is a different random sample, either from the one-dimensional
distribution (labeled <code class="docutils literal notranslate"><span class="pre">n</span></code>) or from the two-dimensional distribution (labeled
<code class="docutils literal notranslate"><span class="pre">a</span></code>). Assuming the file is called <code class="docutils literal notranslate"><span class="pre">datafile</span></code>, this data can be read into
a dictionary, essentially identical to the <code class="docutils literal notranslate"><span class="pre">data</span></code> dictionary above, using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;datafile&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">])</span>
<span class="go">[array([ 0.494, 2.734]), array([ 0.172, 1.400]), array([ 1.571, 1.304]) ... ]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">avg_data</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]))</span>
<span class="go">1.31(45)</span>
</pre></div>
</div>
<p>The brackets and commas can be omitted in the input file for one-dimensional
arrays: for example, <code class="docutils literal notranslate"><span class="pre">datafile</span></code> (above) could equivalently be written</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># file: datafile</span>
<span class="n">n</span> <span class="mf">1.739</span>
<span class="n">a</span> <span class="mf">0.494</span> <span class="mf">2.734</span>
<span class="n">n</span> <span class="mf">2.682</span>
<span class="n">a</span> <span class="mf">0.172</span> <span class="mf">1.400</span>
<span class="o">...</span>
</pre></div>
</div>
<p>Other data formats may also be easy to use. For example, a data file written
using <code class="docutils literal notranslate"><span class="pre">yaml</span></code> would look like</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># file: datafile</span>
<span class="o">---</span>
<span class="n">n</span><span class="p">:</span> <span class="mf">1.739</span>
<span class="n">a</span><span class="p">:</span> <span class="p">[</span> <span class="mf">0.494</span><span class="p">,</span> <span class="mf">2.734</span><span class="p">]</span>
<span class="o">---</span>
<span class="n">n</span><span class="p">:</span> <span class="mf">2.682</span>
<span class="n">a</span><span class="p">:</span> <span class="p">[</span> <span class="mf">0.172</span><span class="p">,</span> <span class="mf">1.400</span><span class="p">]</span>
<span class="o">.</span>
<span class="o">.</span>
<span class="o">.</span>
</pre></div>
</div>
<p>and could be read into a <a class="reference internal" href="#gvar.dataset.Dataset" title="gvar.dataset.Dataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">gvar.dataset.Dataset</span></code></a> using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">yaml</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">()</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;datafile&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">dfile</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load_all</span><span class="p">(</span><span class="n">dfile</span><span class="o">.</span><span class="n">read</span><span class="p">()):</span>   <span class="c1"># iterate over yaml records</span>
        <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>                      <span class="c1"># d is a dictionary</span>
</pre></div>
</div>
<p>Finally note that data can be binned, into bins of size <code class="docutils literal notranslate"><span class="pre">binsize</span></code>, using
<a class="reference internal" href="#gvar.dataset.bin_data" title="gvar.dataset.bin_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">gvar.dataset.bin_data()</span></code></a>. For example,
<code class="docutils literal notranslate"><span class="pre">gvar.dataset.bin_data(data,</span> <span class="pre">binsize=3)</span></code> replaces every three samples in
<code class="docutils literal notranslate"><span class="pre">data</span></code> by the average of those samples. This creates a dataset that is
<code class="docutils literal notranslate"><span class="pre">1/3</span></code> the size of the original but has the same mean. Binning is useful
for making large datasets more manageable, and also for removing
sample-to-sample correlations. Over-binning, however, erases statistical
information.</p>
<p>Class <a class="reference internal" href="#gvar.dataset.Dataset" title="gvar.dataset.Dataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">gvar.dataset.Dataset</span></code></a> can also be used to build a dataset sample by
sample in code: for example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mf">1.739</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="p">[</span> <span class="mf">0.494</span><span class="p">,</span> <span class="mf">2.734</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mf">2.682</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="p">[</span> <span class="mf">0.172</span><span class="p">,</span> <span class="mf">1.400</span><span class="p">])</span>
<span class="gp">...</span>
</pre></div>
</div>
<p>creates the same dataset as above.</p>
</section>
<section id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this heading">¶</a></h2>
<p>The functions defined in the module are:</p>
<dl class="py function">
<dt class="sig sig-object py" id="gvar.dataset.avg_data">
<span class="sig-prename descclassname"><span class="pre">gvar.dataset.</span></span><span class="sig-name descname"><span class="pre">avg_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spread</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">median</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bstrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noerror</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mismatch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'truncate'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unbias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gvar.dataset.avg_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Average <code class="docutils literal notranslate"><span class="pre">dataset</span></code> to estimate means and covariance.</p>
<p><code class="docutils literal notranslate"><span class="pre">dataset</span></code> is a list of random numbers, a list of random arrays, or a dictionary
of lists of random numbers and/or arrays: for example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">random_numbers</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.60</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">,</span> <span class="mf">1.28</span><span class="p">,</span> <span class="mf">1.30</span><span class="p">,</span> <span class="mf">0.54</span><span class="p">,</span> <span class="mf">2.15</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">random_arrays</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">12.2</span><span class="p">,</span><span class="mf">121.3</span><span class="p">],[</span><span class="mf">13.4</span><span class="p">,</span><span class="mf">149.2</span><span class="p">],[</span><span class="mf">11.7</span><span class="p">,</span><span class="mf">135.3</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span><span class="mf">7.2</span><span class="p">,</span><span class="mf">64.6</span><span class="p">],[</span><span class="mf">15.2</span><span class="p">,</span><span class="mf">69.0</span><span class="p">],[</span><span class="mf">8.3</span><span class="p">,</span><span class="mf">108.3</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">random_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">random_numbers</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="n">random_arrays</span><span class="p">)</span>
</pre></div>
</div>
<p>where in each case there are six random numbers/arrays. <code class="docutils literal notranslate"><span class="pre">avg_data</span></code>
estimates the means of the distributions from which the random
numbers/arrays are drawn, together with the uncertainties in those
estimates. The results are returned as a <a class="reference internal" href="gvar.html#gvar.GVar" title="gvar.GVar"><code class="xref py py-class docutils literal notranslate"><span class="pre">gvar.GVar</span></code></a> or an array of
<a class="reference internal" href="gvar.html#gvar.GVar" title="gvar.GVar"><code class="xref py py-class docutils literal notranslate"><span class="pre">gvar.GVar</span></code></a>s, or a dictionary of <a class="reference internal" href="gvar.html#gvar.GVar" title="gvar.GVar"><code class="xref py py-class docutils literal notranslate"><span class="pre">gvar.GVar</span></code></a>s and/or arrays of <a class="reference internal" href="gvar.html#gvar.GVar" title="gvar.GVar"><code class="xref py py-class docutils literal notranslate"><span class="pre">gvar.GVar</span></code></a>s:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">avg_data</span><span class="p">(</span><span class="n">random_numbers</span><span class="p">))</span>
<span class="go">1.31(20)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">avg_data</span><span class="p">(</span><span class="n">random_arrays</span><span class="p">))</span>
<span class="go">[11.3(1.1) 108(13)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">avg_data</span><span class="p">(</span><span class="n">random_dict</span><span class="p">))</span>
<span class="go">{&#39;a&#39;: array([11.3(1.1), 108(13)], dtype=object),&#39;n&#39;: 1.31(20)}</span>
</pre></div>
</div>
<p>The arrays in <code class="docutils literal notranslate"><span class="pre">random_arrays</span></code> are one dimensional; in general, they
can have any shape.</p>
<p><code class="docutils literal notranslate"><span class="pre">avg_data(dataset)</span></code> also estimates any correlations between different
quantities in <code class="docutils literal notranslate"><span class="pre">dataset</span></code>. When <code class="docutils literal notranslate"><span class="pre">dataset</span></code> is a dictionary, it does this by
assuming that the lists of random numbers/arrays for the different
<code class="docutils literal notranslate"><span class="pre">dataset[k]</span></code>s are synchronized, with the first element in one list
corresponding to the first elements in all other lists, and so on.</p>
<p>Note that estimates of the correlations are robust only if the
number of samples being averaged is substantially larger (eg, 10x) than
the number of quantities being averaged. The correlation matrix is
poorly conditioned or singular if the number of samples is too small.
Function <a class="reference internal" href="#gvar.dataset.svd_diagnosis" title="gvar.dataset.svd_diagnosis"><code class="xref py py-func docutils literal notranslate"><span class="pre">gvar.dataset.svd_diagnosis()</span></code></a> can be used to determine
whether there is a problem, and, if so, the problem can be ameliorated by
applying an SVD cut to the data after averaging (<a class="reference internal" href="gvar.html#gvar.regulate" title="gvar.regulate"><code class="xref py py-func docutils literal notranslate"><span class="pre">gvar.regulate()</span></code></a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spread</strong> (<em>bool</em>) – Setting <code class="docutils literal notranslate"><span class="pre">spread=True</span></code> means that
standard deviations in the results refer to spreads in the data, not
uncertainties in the estimates of the means. The former is <code class="docutils literal notranslate"><span class="pre">sqrt(N)</span></code>
larger where <code class="docutils literal notranslate"><span class="pre">N</span></code> is the number of random numbers (or arrays) being
averaged. This is useful, for example, when averaging bootstrap data.
The default value is <code class="docutils literal notranslate"><span class="pre">spread=False</span></code>.</p></li>
<li><p><strong>median</strong> (<em>bool</em>) – Setting <code class="docutils literal notranslate"><span class="pre">median=True</span></code>
replaces the means in the results by medians, while the standard
deviations are approximated by the width of the larger of the intervals
above or below the median that contains 34% of the data. These
estimates are more robust than the mean and standard deviation when
averaging over small amounts of data; in particular, they are
unaffected by extreme outliers in the data. But correlations
between different variables are ignored in this case. The default
is <code class="docutils literal notranslate"><span class="pre">median=False</span></code>.</p></li>
<li><p><strong>bstrap</strong> (<em>bool</em>) – Setting <code class="docutils literal notranslate"><span class="pre">bstrap=True</span></code> is
shorthand for setting <code class="docutils literal notranslate"><span class="pre">median=True</span></code> and <code class="docutils literal notranslate"><span class="pre">spread=True</span></code>, and
overrides any explicit setting for these keyword arguments. This is the
typical choice for analyzing bootstrap data — hence its name. The
default value is <code class="docutils literal notranslate"><span class="pre">bstrap=False</span></code>.</p></li>
<li><p><strong>noerror</strong> (<em>bool</em>) – Error estimates on the averages (and correlations) are omitted
if <code class="docutils literal notranslate"><span class="pre">noerror=True</span></code> is set — just the mean values are
returned. The default value is <code class="docutils literal notranslate"><span class="pre">noerror=False</span></code>.</p></li>
<li><p><strong>mimatch</strong> (<em>str</em>) – <p>The <code class="docutils literal notranslate"><span class="pre">mismatch</span></code> option is only relevant when <code class="docutils literal notranslate"><span class="pre">dataset</span></code> is a
dictionary whose entries <code class="docutils literal notranslate"><span class="pre">dataset[k]</span></code> have different sample sizes. This
complicates the calculation of correlations between the different entries.
There are three choices for <code class="docutils literal notranslate"><span class="pre">mismatch</span></code>:</p>
<blockquote>
<div><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">mismatch='truncate'</span></code>:</dt><dd><p>Samples are discarded from the ends of
entries so that all entries have the same sample size (equal to the
smallest sample size). This is the default.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">mismatch='wavg'</span></code>:</dt><dd><p>The data set is decomposed into a collection of data sets
so that the entries in any given data set all have the same sample size;
no samples are discarded. Each of the resulting data sets is averaged
separately, and the final result is the weighted average of these averages.
This choice is the most accurate but also the slowest, especially for
large problems. It should only be used when the smallest sample size is
much larger (eg, 10x) than the number of quantities being averaged.
It also requires the <code class="xref py py-mod docutils literal notranslate"><span class="pre">lsqfit</span></code> Python module.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">mismatch='decorrelate'</span></code>:</dt><dd><p>Ignores correlations between different
entries <code class="docutils literal notranslate"><span class="pre">dataset[k]</span></code>. All samples are used and correlations within
an entry <code class="docutils literal notranslate"><span class="pre">dataset[k]</span></code> are retained. This is the fastest choice.</p>
</dd>
</dl>
</div></blockquote>
</p></li>
<li><p><strong>unbias</strong> (<em>bool</em>) – The default choice <code class="docutils literal notranslate"><span class="pre">unbias=False</span></code> means that
variances are estimated using <code class="docutils literal notranslate"><span class="pre">mean((x</span> <span class="pre">-</span> <span class="pre">mean(x))**2)/N</span></code>
where <code class="docutils literal notranslate"><span class="pre">N</span></code> is the number of random samples.
This estimate is biased but is typically
more accurate than the unbiased estimate obtained when <code class="docutils literal notranslate"><span class="pre">N</span></code> is
replaced by <code class="docutils literal notranslate"><span class="pre">N-1</span></code> (because statistical fluctuations are then larger
than the bias). The difference is negligible unless <code class="docutils literal notranslate"><span class="pre">N</span></code> is very small.
Setting <code class="docutils literal notranslate"><span class="pre">unbias=True</span></code> gives the unbiased estimate.</p></li>
<li><p><strong>warn</strong> (<em>bool</em>) – <code class="docutils literal notranslate"><span class="pre">warn</span></code> determines whether or not a warning is issued
when different entries in a dictionary data set have different sample
sizes. The default is <code class="docutils literal notranslate"><span class="pre">warn=False</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gvar.dataset.autocorr">
<span class="sig-prename descclassname"><span class="pre">gvar.dataset.</span></span><span class="sig-name descname"><span class="pre">autocorr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gvar.dataset.autocorr" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute autocorrelation in <code class="docutils literal notranslate"><span class="pre">dataset</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">dataset</span></code> is a list of random numbers or random arrays, or a dictionary
of lists of random numbers/arrays.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">dataset</span></code> is a list of random numbers, <code class="docutils literal notranslate"><span class="pre">autocorr(dataset)</span></code> returns
an array where <code class="docutils literal notranslate"><span class="pre">autocorr(dataset)[i]</span></code> is the correlation between
elements in <code class="docutils literal notranslate"><span class="pre">dataset</span></code> that are separated by distance <code class="docutils literal notranslate"><span class="pre">i</span></code> in the list:
for example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">autocorr</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">]))</span>
<span class="go">[ 1. -1.  1. -1.  1. -1.]</span>
</pre></div>
</div>
<p>shows perfect correlation between elements separated by an even
interval in the list, and perfect anticorrelation between elements by
an odd interval.</p>
<p><code class="docutils literal notranslate"><span class="pre">autocorr(dataset)</span></code> returns a list of arrays of autocorrelation
coefficients when <code class="docutils literal notranslate"><span class="pre">dataset</span></code> is a list of random arrays. Again
<code class="docutils literal notranslate"><span class="pre">autocorr(dataset)[i]</span></code> gives the autocorrelations for <code class="docutils literal notranslate"><span class="pre">dataset</span></code> elements
separated by distance <code class="docutils literal notranslate"><span class="pre">i</span></code> in the list. Similarly <code class="docutils literal notranslate"><span class="pre">autocorr(dataset)</span></code>
returns a dictionary when <code class="docutils literal notranslate"><span class="pre">dataset</span></code> is a dictionary.</p>
<p><code class="docutils literal notranslate"><span class="pre">autocorr(dataset)</span></code> uses FFTs to compute the autocorrelations; the cost
of computing the autocorrelations should grow roughly linearly with the
number of random samples in <code class="docutils literal notranslate"><span class="pre">dataset</span></code> (up to logarithms).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gvar.dataset.bin_data">
<span class="sig-prename descclassname"><span class="pre">gvar.dataset.</span></span><span class="sig-name descname"><span class="pre">bin_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gvar.dataset.bin_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Bin random data.</p>
<p><code class="docutils literal notranslate"><span class="pre">dataset</span></code> is a list of random numbers or random arrays, or a
dictionary of lists of random numbers/arrays.
<code class="docutils literal notranslate"><span class="pre">bin_data(dataset,</span> <span class="pre">binsize)</span></code> replaces consecutive groups of
<code class="docutils literal notranslate"><span class="pre">binsize</span></code> numbers/arrays by the average of those numbers/arrays. The
result is new data list (or dictionary) with <code class="docutils literal notranslate"><span class="pre">1/binsize</span></code> times as much
random data: for example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bin_data</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span><span class="n">binsize</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="go">[1.5, 3.5, 5.5]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bin_data</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span><span class="n">v</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">]]),</span><span class="n">binsize</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="go">{&#39;s&#39;: [1.5, 3.5], &#39;v&#39;: [array([ 2.,  3.]), array([ 6.,  7.])]}</span>
</pre></div>
</div>
<p>Data is dropped at the end if there is insufficient data to from complete
bins. Binning is used to make calculations
faster and to reduce measurement-to-measurement correlations, if they
exist. Over-binning erases useful information.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gvar.dataset.bootstrap_iter">
<span class="sig-prename descclassname"><span class="pre">gvar.dataset.</span></span><span class="sig-name descname"><span class="pre">bootstrap_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gvar.dataset.bootstrap_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Create iterator that returns bootstrap copies of <code class="docutils literal notranslate"><span class="pre">dataset</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">dataset</span></code> is a list of random numbers or random arrays, or a dictionary
of lists of random numbers/arrays. <code class="docutils literal notranslate"><span class="pre">bootstrap_iter(dataset,n)</span></code> is an
iterator that returns <code class="docutils literal notranslate"><span class="pre">n</span></code> bootstrap copies of <code class="docutils literal notranslate"><span class="pre">dataset</span></code>. The random
numbers/arrays in a bootstrap copy are drawn at random (with repetition
allowed) from among the samples in <code class="docutils literal notranslate"><span class="pre">dataset</span></code>: for example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_iter</span> <span class="o">=</span> <span class="n">bootstrap_iter</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">data_iter</span><span class="p">))</span>
<span class="go">[ 1.1  1.1  0.5  1.9]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">data_iter</span><span class="p">))</span>
<span class="go">[ 0.5  2.3  1.9  0.5]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span><span class="n">b</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_iter</span> <span class="o">=</span> <span class="n">bootstrap_iter</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">data_iter</span><span class="p">))</span>
<span class="go">{&#39;a&#39;: array([3, 3, 1, 2]), &#39;b&#39;: array([3, 3, 1, 2])}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">data_iter</span><span class="p">))</span>
<span class="go">{&#39;a&#39;: array([1, 3, 3, 2]), &#39;b&#39;: array([1, 3, 3, 2])}</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_iter</span> <span class="o">=</span> <span class="n">bootstrap_iter</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">data_iter</span><span class="p">))</span>
<span class="go">[[ 7.  8.]</span>
<span class="go"> [ 1.  2.]</span>
<span class="go"> [ 1.  2.]</span>
<span class="go"> [ 7.  8.]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">data_iter</span><span class="p">))</span>
<span class="go">[[ 3.  4.]</span>
<span class="go"> [ 7.  8.]</span>
<span class="go"> [ 3.  4.]</span>
<span class="go"> [ 1.  2.]]</span>
</pre></div>
</div>
<p>The distribution of bootstrap copies is an approximation to the
distribution from which <code class="docutils literal notranslate"><span class="pre">dataset</span></code> was drawn. Consequently means,
variances and correlations for bootstrap copies should be similar to
those in <code class="docutils literal notranslate"><span class="pre">dataset</span></code>. Analyzing variations from bootstrap copy to copy is
often useful when dealing with non-gaussian behavior or complicated
correlations between different quantities.</p>
<p>Parameter <code class="docutils literal notranslate"><span class="pre">n</span></code> specifies the maximum number of copies; there is no
maximum if <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">is</span> <span class="pre">None</span></code>.</p>
</dd></dl>

</section>
<section id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Permalink to this heading">¶</a></h2>
<p><a class="reference internal" href="#gvar.dataset.Dataset" title="gvar.dataset.Dataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">gvar.dataset.Dataset</span></code></a> is used to assemble random samples from
multidimensional distributions:</p>
<dl class="py class">
<dt class="sig sig-object py" id="gvar.dataset.Dataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gvar.dataset.</span></span><span class="sig-name descname"><span class="pre">Dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputdata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h5group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gvar.dataset.Dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary for collecting random data.</p>
<p>A <a class="reference internal" href="#gvar.dataset.Dataset" title="gvar.dataset.Dataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">gvar.dataset.Dataset</span></code></a> is an ordered dictionary whose values
represent collections of random samples. Each value is  a <code class="xref py py-mod docutils literal notranslate"><span class="pre">numpy</span></code>
array whose first index labels the random  sample. Random samples can be
numbers or arrays of numbers. The keys identify the quantity being
sampled.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> can be assembled piece by piece, as random data is
accumulated, or it can be read from a file. Consider a situation
where there are four random values for a scalar <code class="docutils literal notranslate"><span class="pre">s</span></code> and
four random values for vector <code class="docutils literal notranslate"><span class="pre">v</span></code>. These can be collected as
follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dset</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="p">[</span><span class="mf">12.2</span><span class="p">,</span> <span class="mf">20.6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dset</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="p">[</span><span class="mf">14.1</span><span class="p">,</span> <span class="mf">19.2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dset</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="p">[</span><span class="mf">10.3</span><span class="p">,</span> <span class="mf">19.7</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dset</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="mf">0.91</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="p">[</span><span class="mf">8.2</span><span class="p">,</span> <span class="mf">21.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">dset</span><span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">])</span>       <span class="c1"># 4 random values of s</span>
<span class="go">[ 1.1, 0.8, 0.95, 0.91]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">dset</span><span class="p">[</span><span class="s1">&#39;v&#39;</span><span class="p">])</span>       <span class="c1"># 4 random vector-values of v</span>
<span class="go">[array([ 12.2,  20.6]), array([ 14.1,  19.2]), array([ 10.3,  19.7]), array([  8.2,  21. ])]</span>
</pre></div>
</div>
<p>The argument to <code class="docutils literal notranslate"><span class="pre">dset.append()</span></code> can also be a dictionary: for example,
<code class="docutils literal notranslate"><span class="pre">dd</span> <span class="pre">=</span> <span class="pre">dict(s=1.1,v=[12.2,20.6]);</span> <span class="pre">dset.append(dd)</span></code> is equivalent to the
first <code class="docutils literal notranslate"><span class="pre">append</span></code> statement above. One can also append data key-by-key: for
example, <code class="docutils literal notranslate"><span class="pre">dset.append('s',1.1);</span> <span class="pre">dset.append('v',[12.2,20.6])</span></code> is
equivalent to the first <code class="docutils literal notranslate"><span class="pre">append</span></code> in the example above.</p>
<p>Use <code class="docutils literal notranslate"><span class="pre">extend</span></code> in place of <code class="docutils literal notranslate"><span class="pre">append</span></code> to add data in batches: for
example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dset</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="p">[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span> <span class="n">v</span><span class="o">=</span><span class="p">[[</span><span class="mf">12.2</span><span class="p">,</span> <span class="mf">20.6</span><span class="p">],</span> <span class="p">[</span><span class="mf">14.1</span><span class="p">,</span> <span class="mf">19.2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dset</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="p">[</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.91</span><span class="p">],</span> <span class="n">v</span><span class="o">=</span><span class="p">[[</span><span class="mf">10.3</span><span class="p">,</span> <span class="mf">19.7</span><span class="p">],[</span><span class="mf">8.2</span><span class="p">,</span> <span class="mf">21.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">dset</span><span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">])</span>       <span class="c1"># 4 random values of s</span>
<span class="go">[ 1.1, 0.8, 0.95, 0.91]</span>
</pre></div>
</div>
<p>gives the same dataset as the first example above.</p>
<p>The same <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> can also be created from a text file named
<code class="docutils literal notranslate"><span class="pre">'datafile'</span></code> with the following contents:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># file: datafile</span>
<span class="n">s</span> <span class="mf">1.1</span>
<span class="n">v</span> <span class="p">[</span><span class="mf">12.2</span><span class="p">,</span> <span class="mf">20.6</span><span class="p">]</span>
<span class="n">s</span> <span class="mf">0.8</span>
<span class="n">v</span> <span class="p">[</span><span class="mf">14.1</span><span class="p">,</span> <span class="mf">19.2</span><span class="p">]</span>
<span class="n">s</span> <span class="mf">0.95</span>
<span class="n">v</span> <span class="p">[</span><span class="mf">10.3</span><span class="p">,</span> <span class="mf">19.7</span><span class="p">]</span>
<span class="n">s</span> <span class="mf">0.91</span>
<span class="n">v</span> <span class="p">[</span><span class="mf">8.2</span><span class="p">,</span> <span class="mf">21.0</span><span class="p">]</span>
</pre></div>
</div>
<p>Here each line consists of a key  followed by a new random sample for that
key. Lines that begin with <code class="docutils literal notranslate"><span class="pre">#</span></code> are ignored. The file is  read using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="s1">&#39;datafile&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">dset</span><span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">])</span>
<span class="go">[ 1.1, 0.8, 0.95, 0.91]</span>
</pre></div>
</div>
<p>Data can be binned while reading it in, which might be useful if
the data set is huge or if correlations are a concern.
To bin the data contained in file <code class="docutils literal notranslate"><span class="pre">datafile</span></code> in
bins of bin size 2 we use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="s1">&#39;datafile&#39;</span><span class="p">,</span> <span class="n">binsize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">dset</span><span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">])</span>
<span class="go">[0.95, 0.93]</span>
</pre></div>
</div>
<p>The keys read from a data file are restricted to those listed in keyword
<code class="docutils literal notranslate"><span class="pre">keys</span></code> and those that are matched (or partially matched) by regular
expression <code class="docutils literal notranslate"><span class="pre">grep</span></code> if one or other of these is specified: for
example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="s1">&#39;datafile&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">([</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dset</span><span class="p">])</span>
<span class="go">[&#39;s&#39;, &#39;v&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="s1">&#39;datafile&#39;</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;v&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">([</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dset</span><span class="p">])</span>
<span class="go">[&#39;v&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="s1">&#39;datafile&#39;</span><span class="p">,</span> <span class="n">grep</span><span class="o">=</span><span class="s1">&#39;[^v]&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">([</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dset</span><span class="p">])</span>
<span class="go">[&#39;s&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="s1">&#39;datafile&#39;</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;v&#39;</span><span class="p">],</span> <span class="n">grep</span><span class="o">=</span><span class="s1">&#39;[^v]&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">([</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dset</span><span class="p">])</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>In addition to text files, hdf5 files can also be read (provided
module <code class="xref py py-mod docutils literal notranslate"><span class="pre">h5py</span></code> is available): for example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="s1">&#39;datafile.h5&#39;</span><span class="p">,</span> <span class="n">h5group</span><span class="o">=</span><span class="s1">&#39;/mcdata&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>reads the hdf5 datasets in hdf5 group <code class="docutils literal notranslate"><span class="pre">'/mcdata'</span></code>. An hdf5
equivalent to the text file above would contain two groups,
one with key <code class="docutils literal notranslate"><span class="pre">'s'</span></code> that is a one-dimensional array with shape (4,),
and another with key <code class="docutils literal notranslate"><span class="pre">'v'</span></code> that is a two-dimensional array
with shape (4, 2):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">h5py</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s1">&#39;datafile.h5&#39;</span><span class="p">)[</span><span class="s1">&#39;/mcdata&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">&lt;HDF5 dataset &quot;s&quot;: shape (4,), type &quot;&lt;f8&quot;&gt;</span>
<span class="go">&lt;HDF5 dataset &quot;v&quot;: shape (4, 2), type &quot;&lt;f8&quot;&gt;</span>
</pre></div>
</div>
<p>Finally, <a class="reference internal" href="#gvar.dataset.Dataset" title="gvar.dataset.Dataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></a>s can also be constructed from other
dictionaries (including other <a class="reference internal" href="#gvar.dataset.Dataset" title="gvar.dataset.Dataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></a>s), or lists of key-data
tuples. For example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="s1">&#39;datafile&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dset_binned</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">dset</span><span class="p">,</span> <span class="n">binsize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dset_v</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">dset</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;v&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>reads data from file <code class="docutils literal notranslate"><span class="pre">'datafile'</span></code> into <a class="reference internal" href="#gvar.dataset.Dataset" title="gvar.dataset.Dataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></a> <code class="docutils literal notranslate"><span class="pre">dset</span></code>, and
then creates a new <a class="reference internal" href="#gvar.dataset.Dataset" title="gvar.dataset.Dataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></a> with the data binned
(<code class="docutils literal notranslate"><span class="pre">dset_binned</span></code>), and another that only contains the data with key
<code class="docutils literal notranslate"><span class="pre">'v'</span></code> (<code class="docutils literal notranslate"><span class="pre">dset_v</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputdata</strong> (<em>str</em><em> or </em><em>list</em><em> or </em><em>dictionary</em>) – <p>If <code class="docutils literal notranslate"><span class="pre">inputdata</span></code> is a string,
it is the name of a file containing datasets. Two formats are
supported. If the filename ends in ‘.h5’, the file is in hdf5
format,  with datasets that are <code class="xref py py-mod docutils literal notranslate"><span class="pre">numpy</span></code> arrays whose first
index labels the random sample.</p>
<p>The other file format is a text file where each line consists of
a key followed by a number or array of numbers representing a new
random sample associated  with that key. Lines beginning with
<code class="docutils literal notranslate"><span class="pre">#</span></code> are comments. A list of text file names can also be
supplied, and text files can be compressed (with names ending in
<code class="docutils literal notranslate"><span class="pre">.gz</span></code> or <code class="docutils literal notranslate"><span class="pre">.bz2</span></code>).</p>
<p>If <code class="docutils literal notranslate"><span class="pre">inputdata</span></code> is a dictionary or a list of (key,value) tuples,
its keys and values are copied into the dataset. Its values should
be arrays whose first index labels the random sample.</p>
</p></li>
<li><p><strong>binsize</strong> (<em>int</em>) – Bin the random samples in bins of size <code class="docutils literal notranslate"><span class="pre">binsize</span></code>.
Default value is <code class="docutils literal notranslate"><span class="pre">binsize=1</span></code> (<em>i.e.</em>, no binning).</p></li>
<li><p><strong>grep</strong> (str or <code class="docutils literal notranslate"><span class="pre">None</span></code>) – If not <code class="docutils literal notranslate"><span class="pre">None</span></code>, only keys that match or
partially match regular expression <code class="docutils literal notranslate"><span class="pre">grep</span></code> are retained in
the data set. Keys that don’t match are ignored. Default is
<code class="docutils literal notranslate"><span class="pre">grep=None</span></code>.</p></li>
<li><p><strong>keys</strong> (<em>list</em>) – List of keys to retain in data set. Keys that are not
in the list are ignored. Default is <code class="docutils literal notranslate"><span class="pre">keys=None</span></code> which implies
that all keys are kept.</p></li>
<li><p><strong>h5group</strong> (<em>str</em><em> or </em><em>list</em>) – Address within the hdf5 file identified by
<code class="docutils literal notranslate"><span class="pre">inputdata</span></code> that contains the relevant datasets. Every
hdf5 dataset in group <code class="docutils literal notranslate"><span class="pre">h5group</span></code> is
read into the dataset, with the same key as in <code class="docutils literal notranslate"><span class="pre">h5group</span></code>.
Default is the top group in the file: <code class="docutils literal notranslate"><span class="pre">h5group='/'</span></code>.
<code class="docutils literal notranslate"><span class="pre">h5group</span></code> can also be a list of groups, in which case
datasets from all of the groups are read.</p></li>
</ul>
</dd>
</dl>
<p>The main attributes and methods are:</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="gvar.dataset.Dataset.samplesize">
<span class="sig-name descname"><span class="pre">samplesize</span></span><a class="headerlink" href="#gvar.dataset.Dataset.samplesize" title="Permalink to this definition">¶</a></dt>
<dd><p>Smallest number of samples for any key.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gvar.dataset.Dataset.append">
<span class="sig-name descname"><span class="pre">append</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gvar.dataset.Dataset.append" title="Permalink to this definition">¶</a></dt>
<dd><p>Append data to dataset.</p>
<p>There are three equivalent ways of adding data to a dataset
<code class="docutils literal notranslate"><span class="pre">data</span></code>: for example, each of</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mf">1.739</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="mf">0.494</span><span class="p">,</span><span class="mf">2.734</span><span class="p">])</span>        <span class="c1"># method 1</span>

<span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mf">1.739</span><span class="p">)</span>                        <span class="c1"># method 2</span>
<span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">,[</span><span class="mf">0.494</span><span class="p">,</span><span class="mf">2.734</span><span class="p">])</span>

<span class="n">dd</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mf">1.739</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="mf">0.494</span><span class="p">,</span><span class="mf">2.734</span><span class="p">])</span>          <span class="c1"># method 3</span>
<span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dd</span><span class="p">)</span>
</pre></div>
</div>
<p>adds one new random number to <code class="docutils literal notranslate"><span class="pre">data['n']</span></code>, and a new
vector to <code class="docutils literal notranslate"><span class="pre">data['a']</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gvar.dataset.Dataset.extend">
<span class="sig-name descname"><span class="pre">extend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gvar.dataset.Dataset.extend" title="Permalink to this definition">¶</a></dt>
<dd><p>Add batched data to dataset.</p>
<p>There are three equivalent ways of adding batched data, containing
multiple samples for each quantity, to a dataset <code class="docutils literal notranslate"><span class="pre">data</span></code>: for
example, each of</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="p">[</span><span class="mf">1.739</span><span class="p">,</span><span class="mf">2.682</span><span class="p">],</span>
            <span class="n">a</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.494</span><span class="p">,</span><span class="mf">2.734</span><span class="p">],[</span> <span class="mf">0.172</span><span class="p">,</span> <span class="mf">1.400</span><span class="p">]])</span>  <span class="c1"># method 1</span>

<span class="n">data</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">n</span><span class="p">,[</span><span class="mf">1.739</span><span class="p">,</span><span class="mf">2.682</span><span class="p">])</span>                    <span class="c1"># method 2</span>
<span class="n">data</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">a</span><span class="p">,[[</span><span class="mf">0.494</span><span class="p">,</span><span class="mf">2.734</span><span class="p">],[</span> <span class="mf">0.172</span><span class="p">,</span> <span class="mf">1.400</span><span class="p">]])</span>

<span class="n">dd</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="p">[</span><span class="mf">1.739</span><span class="p">,</span><span class="mf">2.682</span><span class="p">],</span>
            <span class="n">a</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.494</span><span class="p">,</span><span class="mf">2.734</span><span class="p">],[</span> <span class="mf">0.172</span><span class="p">,</span> <span class="mf">1.400</span><span class="p">]])</span>  <span class="c1"># method 3</span>
<span class="n">data</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">dd</span><span class="p">)</span>
</pre></div>
</div>
<p>adds two new random numbers to <code class="docutils literal notranslate"><span class="pre">data['n']</span></code>, and two new
random vectors to <code class="docutils literal notranslate"><span class="pre">data['a']</span></code>.</p>
<p>This method can be used to merge two datasets, whether or not they
share keys: for example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;file1&quot;</span><span class="p">)</span>
<span class="n">data_extra</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;file2&quot;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">data_extra</span><span class="p">)</span>   <span class="c1"># data now contains all of data_extra</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gvar.dataset.Dataset.grep">
<span class="sig-name descname"><span class="pre">grep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rexp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gvar.dataset.Dataset.grep" title="Permalink to this definition">¶</a></dt>
<dd><p>Create new dataset containing items whose keys match <code class="docutils literal notranslate"><span class="pre">rexp</span></code>.</p>
<p>Returns a new <code class="xref py py-class docutils literal notranslate"><span class="pre">gvar.dataset.Dataset`</span></code> containing only the
items <code class="docutils literal notranslate"><span class="pre">self[k]</span></code> whose keys <code class="docutils literal notranslate"><span class="pre">k</span></code> match regular expression
<code class="docutils literal notranslate"><span class="pre">rexp</span></code> (a string) according to Python module <code class="xref py py-mod docutils literal notranslate"><span class="pre">re</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xx</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span><span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mf">10.</span><span class="p">,</span><span class="mf">100.</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xx</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span><span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mf">20.</span><span class="p">,</span><span class="mf">200.</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">grep</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))</span>
<span class="go">{&#39;yy&#39;: [array([  10.,  100.]), array([  20.,  200.])]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">grep</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">))</span>
<span class="go">{&#39;xx&#39;: [1.0, 2.0], &#39;xy&#39;: [array([  10.,  100.]), array([  20.,  200.])]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">grep</span><span class="p">(</span><span class="s1">&#39;x|y&#39;</span><span class="p">))</span>
<span class="go">{&#39;xx&#39;: [1.0, 2.0], &#39;xy&#39;: [array([  10.,  100.]), array([  20.,  200.])]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">a</span><span class="o">.</span><span class="n">grep</span><span class="p">(</span><span class="s1">&#39;[^y][^x]&#39;</span><span class="p">)</span>
<span class="go">{&#39;xy&#39;: [array([  10.,  100.]), array([  20.,  200.])]}</span>
</pre></div>
</div>
<p>Items are retained even if <code class="docutils literal notranslate"><span class="pre">rexp</span></code> matches only part of the item’s
key.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gvar.dataset.Dataset.slice">
<span class="sig-name descname"><span class="pre">slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sl</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gvar.dataset.Dataset.slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Create new dataset with <code class="docutils literal notranslate"><span class="pre">self[k]</span> <span class="pre">-&gt;</span> <span class="pre">self[k][sl].</span></code></p>
<p>Parameter <code class="docutils literal notranslate"><span class="pre">sl</span></code> is a slice object that is applied to every
item in the dataset to produce a new <code class="xref py py-class docutils literal notranslate"><span class="pre">gvar.Dataset</span></code>.
Setting <code class="docutils literal notranslate"><span class="pre">sl</span> <span class="pre">=</span> <span class="pre">slice(0,None,2)</span></code>, for example, discards every
other sample for each quantity in the dataset. Setting
<code class="docutils literal notranslate"><span class="pre">sl</span> <span class="pre">=</span> <span class="pre">slice(100,None)</span></code> discards the first 100 samples for
each quantity.</p>
<p>If parameter <code class="docutils literal notranslate"><span class="pre">sl</span></code> is a tuple of slice objects, these
are applied to successive indices of <code class="docutils literal notranslate"><span class="pre">self[k]</span></code>. An exception
is called if the number of slice objects exceeds the number
of dimensions for any <code class="docutils literal notranslate"><span class="pre">self[k]</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gvar.dataset.Dataset.arrayzip">
<span class="sig-name descname"><span class="pre">arrayzip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">template</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gvar.dataset.Dataset.arrayzip" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge lists of random data according to <code class="docutils literal notranslate"><span class="pre">template</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">template</span></code> is an array of keys in the dataset, where the shapes
of <code class="docutils literal notranslate"><span class="pre">self[k]</span></code> are the same for all keys <code class="docutils literal notranslate"><span class="pre">k</span></code> in <code class="docutils literal notranslate"><span class="pre">template</span></code>.
<code class="docutils literal notranslate"><span class="pre">self.arrayzip(template)</span></code> merges the lists of random
numbers/arrays associated with these keys to create a new list of
(merged) random arrays whose layout is specified by <code class="docutils literal notranslate"><span class="pre">template</span></code>:
for example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>            <span class="c1"># three random samples each for a and b</span>
<span class="go">{&#39;a&#39;: [1.0, 2.0, 3.0], &#39;b&#39;: [10.0, 20.0, 30.0]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># merge into list of 2-vectors:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">arrayzip</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">]))</span>
<span class="go">[[  1.  10.]</span>
<span class="go"> [  2.  20.]</span>
<span class="go"> [  3.  30.]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># merge into list of (symmetric) 2x2 matrices:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">arrayzip</span><span class="p">([[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">],[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">]]))</span>
<span class="go">[[[ 10.   1.]</span>
<span class="go">  [  1.  10.]]</span>

<span class="go"> [[ 20.   2.]</span>
<span class="go">  [  2.  20.]]</span>

<span class="go"> [[ 30.   3.]</span>
<span class="go">  [  3.  30.]]]</span>
</pre></div>
</div>
<p>The number of samples in each merged result is the same as the
number samples for each key (here 3). The keys used in this example
represent scalar quantities; in general, they could be either
scalars or arrays (of any shape, so long as all have the same
shape).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gvar.dataset.Dataset.trim">
<span class="sig-name descname"><span class="pre">trim</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gvar.dataset.Dataset.trim" title="Permalink to this definition">¶</a></dt>
<dd><p>Create new dataset where all entries have same sample size.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gvar.dataset.Dataset.toarray">
<span class="sig-name descname"><span class="pre">toarray</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gvar.dataset.Dataset.toarray" title="Permalink to this definition">¶</a></dt>
<dd><p>Create new dictionary <code class="docutils literal notranslate"><span class="pre">d</span></code> where <code class="docutils literal notranslate"><span class="pre">d[k]=numpy.array(self[k])</span></code> for all <code class="docutils literal notranslate"><span class="pre">k</span></code>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gvar.dataset.svd_diagnosis">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gvar.dataset.</span></span><span class="sig-name descname"><span class="pre">svd_diagnosis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbstrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mincut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">models</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_dataset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gvar.dataset.svd_diagnosis" title="Permalink to this definition">¶</a></dt>
<dd><p>Diagnose the need for an SVD cut.</p>
<p><a class="reference internal" href="#gvar.dataset.svd_diagnosis" title="gvar.dataset.svd_diagnosis"><code class="xref py py-class docutils literal notranslate"><span class="pre">gvar.dataset.svd_diagnosis</span></code></a> bootstraps the spectrum of
the correlation matrix for the data in <code class="docutils literal notranslate"><span class="pre">dataset</span></code> to determine
how much of that spectrum is reliably determined by this data.</p>
<p>Here <code class="docutils literal notranslate"><span class="pre">dataset</span></code> is a list of random arrays or a dictionary
(e.g., <a class="reference internal" href="#gvar.dataset.Dataset" title="gvar.dataset.Dataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">gvar.dataset.Dataset</span></code></a>) whose values are lists
of random numbers or random arrays. The random numbers or
arrays are averaged (using <a class="reference internal" href="#gvar.dataset.avg_data" title="gvar.dataset.avg_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">gvar.dataset.avg_data()</span></code></a>)
to produce a set <a class="reference internal" href="gvar.html#gvar.GVar" title="gvar.GVar"><code class="xref py py-class docutils literal notranslate"><span class="pre">gvar.GVar</span></code></a>s and their correlation matrix.
The smallest eigenvalues of the correlation matrix are poorly
estimated when the number of random samples is insufficiently
large — the number of samples should typically be significantly
larger than the number of random variables being analyzed in
order to get good estimates of the correlations between these
variables.</p>
<p>Typical usage is</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gvar</span> <span class="k">as</span> <span class="nn">gv</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">svd_diagnosis</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
<span class="n">avgdata</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">avgdata</span><span class="p">,</span> <span class="n">svdcut</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">svdcut</span><span class="p">)</span>
<span class="n">s</span><span class="o">.</span><span class="n">plot_ratio</span><span class="p">(</span><span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>where the defective part of the correlation matrix is corrected by
applying an SVD cut to the averaged data. A plot showing the ratio
of bootstrapped eigenvalues to the actual eigenvalues is displayed
by the <code class="docutils literal notranslate"><span class="pre">s.plot_ratio</span></code> command.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> – List of random arrays or a dictionary
(e.g., <a class="reference internal" href="#gvar.dataset.Dataset" title="gvar.dataset.Dataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">gvar.dataset.Dataset</span></code></a>) whose values are lists
of random numbers or random arrays. Alternatively it can
be a tuple <code class="docutils literal notranslate"><span class="pre">(g,</span> <span class="pre">Ns)</span></code> where: <code class="docutils literal notranslate"><span class="pre">g</span></code> is an array of
<a class="reference internal" href="gvar.html#gvar.GVar" title="gvar.GVar"><code class="xref py py-class docutils literal notranslate"><span class="pre">gvar.GVar</span></code></a>s or a dictionary whose values are <a class="reference internal" href="gvar.html#gvar.GVar" title="gvar.GVar"><code class="xref py py-class docutils literal notranslate"><span class="pre">gvar.GVar</span></code></a>s or
arrays of <a class="reference internal" href="gvar.html#gvar.GVar" title="gvar.GVar"><code class="xref py py-class docutils literal notranslate"><span class="pre">gvar.GVar</span></code></a>s; and <code class="docutils literal notranslate"><span class="pre">Ns</span></code> is the number of random
samples. Then the list of random data that is analyzed is
created is created using <code class="docutils literal notranslate"><span class="pre">gvar.raniter(g,</span> <span class="pre">n=Ns)</span></code>.</p></li>
<li><p><strong>nbstrap</strong> – Number of bootstrap copies used (default is 50).</p></li>
<li><p><strong>models</strong> – For use in conjunction with <code class="xref py py-class docutils literal notranslate"><span class="pre">lsqfit.MultiFitter</span></code>;
ignored when not specified. When specified, it is a list of multi-
fitter models used to specify which parts of the data are being
analyzed. The correlation matrix is restricted to the data
specified by the models and the data returned are “processed data”
for use with a multi-fitter using keyword <code class="docutils literal notranslate"><span class="pre">pdata</span></code> rather than
<code class="docutils literal notranslate"><span class="pre">data</span></code>. Ignored if keyword <code class="docutils literal notranslate"><span class="pre">process_datasets</span></code> is specified.</p></li>
<li><p><strong>process_dataset</strong> – Function that converts datasets into averaged
data. Function <a class="reference internal" href="#gvar.dataset.avg_data" title="gvar.dataset.avg_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">gvar.dataset.avg_data()</span></code></a> is used if
set equal to <code class="docutils literal notranslate"><span class="pre">None</span></code> (default).</p></li>
<li><p><strong>mincut</strong> – Minimum SVD cut (default 1e-12).</p></li>
</ul>
</dd>
</dl>
<p>The main attributes are:</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="gvar.dataset.svd_diagnosis.svdcut">
<span class="sig-name descname"><span class="pre">svdcut</span></span><a class="headerlink" href="#gvar.dataset.svd_diagnosis.svdcut" title="Permalink to this definition">¶</a></dt>
<dd><p>SVD cut for bad eigenvalues in correlation matrix.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="gvar.dataset.svd_diagnosis.eps">
<span class="sig-name descname"><span class="pre">eps</span></span><a class="headerlink" href="#gvar.dataset.svd_diagnosis.eps" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">eps</span></code> corresponding to <code class="docutils literal notranslate"><span class="pre">svdcut</span></code>, for use in <a class="reference internal" href="gvar.html#gvar.regulate" title="gvar.regulate"><code class="xref py py-func docutils literal notranslate"><span class="pre">gvar.regulate()</span></code></a>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="gvar.dataset.svd_diagnosis.avgdata">
<span class="sig-name descname"><span class="pre">avgdata</span></span><a class="headerlink" href="#gvar.dataset.svd_diagnosis.avgdata" title="Permalink to this definition">¶</a></dt>
<dd><p>Averaged data (<code class="docutils literal notranslate"><span class="pre">gvar.dataset.avg_data(dataset)</span></code>).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="gvar.dataset.svd_diagnosis.val">
<span class="sig-name descname"><span class="pre">val</span></span><a class="headerlink" href="#gvar.dataset.svd_diagnosis.val" title="Permalink to this definition">¶</a></dt>
<dd><p>Eigenvalues of the correlation matrix.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="gvar.dataset.svd_diagnosis.bsval">
<span class="sig-name descname"><span class="pre">bsval</span></span><a class="headerlink" href="#gvar.dataset.svd_diagnosis.bsval" title="Permalink to this definition">¶</a></dt>
<dd><p>Bootstrap average of correlation matrix eigenvalues.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="gvar.dataset.svd_diagnosis.nmod">
<span class="sig-name descname"><span class="pre">nmod</span></span><a class="headerlink" href="#gvar.dataset.svd_diagnosis.nmod" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of eigenmodes modified by SVD cut <code class="docutils literal notranslate"><span class="pre">svdcut</span></code>.</p>
</dd></dl>

<p>A method is available to display the eigenvalues:</p>
<dl class="py method">
<dt class="sig sig-object py" id="gvar.dataset.svd_diagnosis.plot_ratio">
<span class="sig-name descname"><span class="pre">plot_ratio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gvar.dataset.svd_diagnosis.plot_ratio" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot ratio of bootstrapped eigenvalues divided by actual eigenvalues.</p>
<p>Ratios (blue points) are plotted versus the value of the actual
eigenvalues divided by the maximum eigenvalue. Error bars on
the ratios show the range of variation across bootstrapped copies.
A dotted line is drawn at <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">-</span> <span class="pre">sqrt(2/N)</span></code>, where <code class="docutils literal notranslate"><span class="pre">N</span></code> is the
number of data points. The proposed SVD cut is where the
ratio curve intersects this line; that point is indicated
by a vertical dashed red line. The plot object is returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plot</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib</span></code> plotter used to make plot.
Uses <code class="docutils literal notranslate"><span class="pre">plot</span> <span class="pre">=</span> <span class="pre">matplotlib.pyplot</span></code> if <code class="docutils literal notranslate"><span class="pre">plot=None</span></code> (default).</p></li>
<li><p><strong>show</strong> – Displays the plot if <code class="docutils literal notranslate"><span class="pre">show=True</span></code> (default <code class="docutils literal notranslate"><span class="pre">False</span></code>).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">gvar.dataset</span></code> - Random Data Sets</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#functions">Functions</a></li>
<li><a class="reference internal" href="#classes">Classes</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="gvar.html"
                          title="previous chapter"><code class="xref py py-mod docutils literal notranslate"><span class="pre">gvar</span></code> - Gaussian Random Variables</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="gvar_other.html"
                          title="next chapter">Numerical Analysis Modules in <code class="xref py py-mod docutils literal notranslate"><span class="pre">gvar</span></code></a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/gvar_dataset.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="gvar_other.html" title="Numerical Analysis Modules in gvar"
             >next</a> |</li>
        <li class="right" >
          <a href="gvar.html" title="gvar - Gaussian Random Variables"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">gvar 12.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><code class="xref py py-mod docutils literal notranslate"><span class="pre">gvar.dataset</span></code> - Random Data Sets</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2009-2023, G. P. Lepage.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.0.2.
    </div>
  </body>
</html>